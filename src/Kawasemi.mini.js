function on_kawasemi(G,H){function y(){return{_mode:"[stack]",_type:"list",_val:[],_name:"null",_const:!1}}function I(h){for(var a in h){var g=h[a];"list"===g._type?I(g._val):"func_no"===g._type&&"dtor"===g._name&&z(r[g._val])}}function B(E){for(var a=y();E<h.length;){var g=h.pop();"list"===g._type?I(g._val):"func_no"===g._type&&"dtor"===g._name?a=z(r[g._val]):"out"===g._name&&(a=g)}return a}function z(E){function a(a){w.push("syntax-error : "+a+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"error",
_val:"syntax-error : "+a,_goto:"top"}}function g(a){w.push("exception : "+a+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"exception",_val:"exception : "+a,_goto:"top"}}function l(a){if("list_no"===a._type){var d=h.length;a=z(r[a._val]);if("[event]"===a._mode)return a;for(;d<h.length;)h.pop();var d={_mode:"[stack]",_type:"map",_val:[],_name:"literal",_const:!1},b;for(b in a){var e=a[b];"[stack]"===e._mode&&"literal"===e._name&&(e._name=""+b,e._this=d,d._type="list")}d._val=a;return d}if("ident"!==
a._type)return a;b=a._val;for(a=h.length-1;0<=a;a--)if("[stack]"===h[a]._mode&&h[a]._name===b)return h[a];w.push("undefined-var (137): "+b+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"error",_val:"undefined-var : "+b,_goto:"top"}}function k(d,b){var e=l(b);if("[event]"===e._mode)return e;if("ident"!==d._type){if(!0===d._const&&!0===d._this._const)return a("do not set const (155):"+d._name+":"+d._val);d._val=e._val;d._type=e._type;return d}for(var f=h.length-1;0<=f;f--){var g=h[f];if("[stack]"===
g._mode&&g._name===d._val){if(!0===g._const)return a("do not set const (170): "+g._name+":"+g._val);g._val=e._val;g._type=e._type;e=A(g);e._name="literal";return e}}w.push("undefined-var (183): "+d._name+":"+d._val+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"error",_val:"undefined-var : "+d._val,_goto:"top"}}function p(d,b,e){b=l(b);if("[event]"===b._mode)return b;e=l(e);if("[event]"===e._mode)return e;if(b._type!==e._type)return{_mode:"[stack]",_type:"bool",_val:!1,_name:"literal",_const:!0};
if("(>"===d)return{_mode:"[stack]",_type:"bool",_val:b._val>e._val,_name:"literal",_const:!0};if("(<"===d)return{_mode:"[stack]",_type:"bool",_val:b._val<e._val,_name:"literal",_const:!0};if("(>="===d)return{_mode:"[stack]",_type:"bool",_val:b._val>=e._val,_name:"literal",_const:!0};if("(<="===d)return{_mode:"[stack]",_type:"bool",_val:b._val<=e._val,_name:"literal",_const:!0};if("(=="===d)return{_mode:"[stack]",_type:"bool",_val:b._val===e._val,_name:"literal",_const:!0};if("(!="===d)return{_mode:"[stack]",
_type:"bool",_val:b._val!==e._val,_name:"literal",_const:!0};if("(&&"===d)return{_mode:"[stack]",_type:"bool",_val:b._val&&e._val,_name:"literal",_const:!0};if("(||"===d)return{_mode:"[stack]",_type:"bool",_val:b._val||e._val,_name:"literal",_const:!0};if("str"===b._type&&"str"===e._type&&1===b._val.length&&1===e._val.length){if("(+"===d)return{_mode:"[stack]",_type:b._type,_val:String.fromCharCode(b._val.charCodeAt(0)+e._val.charCodeAt(0)),_name:"literal",_const:!0};if("(-"===d)return{_mode:"[stack]",
_type:b._type,_val:String.fromCharCode(b._val.charCodeAt(0)-e._val.charCodeAt(0)),_name:"literal",_const:!0}}return"(*"===d?{_mode:"[stack]",_type:b._type,_val:b._val*e._val,_name:"literal",_const:!0}:"(/"===d?{_mode:"[stack]",_type:b._type,_val:Math.floor(b._val/e._val),_name:"literal",_const:!0}:"(+"===d?{_mode:"[stack]",_type:b._type,_val:b._val+e._val,_name:"literal",_const:!0}:"(-"===d?{_mode:"[stack]",_type:b._type,_val:b._val-e._val,_name:"literal",_const:!0}:"(&"===d?{_mode:"[stack]",_type:b._type,
_val:b._val&e._val,_name:"literal",_const:!0}:"(|"===d?{_mode:"[stack]",_type:b._type,_val:b._val|e._val,_name:"literal",_const:!0}:"(^"===d?{_mode:"[stack]",_type:b._type,_val:b._val^e._val,_name:"literal",_const:!0}:"(>>"===d?{_mode:"[stack]",_type:b._type,_val:b._val>>e._val,_name:"literal",_const:!0}:a(d)}function C(d,b,e){e=l(e);if("[event]"===e._mode)return e;if("int"!==e._type)return a("type not-match (1252): "+e._name+":"+e._val+" "+e._type);if("ident"!==b._type){if(!0===b._const)return a("do not set const (1255):"+
b._name+":"+b._val);if("int"!==b._type)return a("type not-match (1256):"+b._name+":"+b._val);if("*="===d)return{_mode:"[stack]",_type:"int",_val:b._val*=e._val,_name:"literal",_const:!1};if("/="===d)return{_mode:"[stack]",_type:"int",_val:b._val=Math.floor(b._val/e._val),_name:"literal",_const:!1};if("+="===d)return{_mode:"[stack]",_type:"int",_val:b._val+=e._val,_name:"literal",_const:!1};if("-="===d)return{_mode:"[stack]",_type:"int",_val:b._val-=e._val,_name:"literal",_const:!1};w.push("undefined-var (247): "+
b._val+" "+d+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"error",_val:"undefined-var:"+b._val,_goto:"top"}}for(var f=b._val,g=h.length-1;0<=g;g--){var k=h[g];if(k._name===f){if(!0===k._const)return a("do not set const (1272): "+k._name+":"+k._val);if("int"!==k._type)return a("type not-match (1273):"+k._name+":"+k._val);if("*="===d)return{_mode:"[stack]",_type:"int",_val:k._val*=e._val,_name:"literal",_const:!1};if("/="===d)return{_mode:"[stack]",_type:"int",_val:k._val/=e._val,_name:"literal",
_const:!1};if("+="===d)return{_mode:"[stack]",_type:"int",_val:k._val+=e._val,_name:"literal",_const:!1};if("-="===d)return{_mode:"[stack]",_type:"int",_val:k._val-=e._val,_name:"literal",_const:!1}}}w.push("undefined-var (266): "+b._name+":"+b._val+" "+d+(""===u?"":"\n\tline:"+u));return{_mode:"[event]",_type:"error",_val:"undefined-var:"+b._val,_goto:"top"}}function A(a){return{_mode:a._mode,_type:a._type,_val:a._val,_name:a._name,_const:a._const}}if(!E)return[];for(var m=[],F=0;F<E.length;F++){var f=
E[F];if("ident"!==f._type||")"!==f._val){if("("===f._val||"(each"===f._val||"(loop"===f._val)f._stack_length=h.length;m.push(f)}else{for(var e=[],b=m.length-1;0<=b;--b){var d=m.pop();e.unshift(d);if("ident"===d._type&&"("===d._val[0])break}if(!(0>=e.length))if(f=e[0]._val,"("===f)if(2>e.length)m.push(y());else{b=B(e[0]._stack_length);if("[event]"===b._mode)return b;"null"===b._name?m.push(e[e.length-1]):m.push(b)}else if("(at"===f||"(."===f){if(3>e.length)return a("arg_size < 3 : "+f);if("@"===e[1]._val)d=
A(e[1]),d._val=e[1]._val+e[2]._val,d._type="int",m.push(d);else{b=l(e[1]);if("[event]"===b._mode)return b;d=!1;if("[stack]"===b._mode&&("list"===b._type||"map"===b._type)){var v=e[2];"(at"===f&&(v=l(e[2]));if(("list"===b._type||"map"===b._type)&&"int"===v._type&&0<=v._val&&v._val<b._val.length)m.push(b._val[v._val]),d=!0;else{e=v._val;"map"===b._type&&(e=""+e);for(var n in b._val){d=b._val[n];if(d._name===e){m.push(d);break}d=!1}if(!1===d){var s="";for(n=h.length-1;0<=n;n--)if("[stack]"===h[n]._mode&&
h[n]._name===e){d=h[n];break}!1!==d&&"int"===d._type&&0<=d._val&&d._val<b._val.length&&m.push(b._val[d._val])}}if(!1===d)for(n in b._val){d=b._val[n];if("unmatch"===d._name){m.push(d);break}d=!1}}if(!1===d)return w.push("undefined-var (394): "+v._name+":"+v._val+(""===u?"":"\n\tline:"+u)),{_mode:"[event]",_type:"error",_val:"undefined-var : "+v._val,_goto:"top"}}}else if("(:"===f||"(::"===f){if(3>e.length)return a("arg_size < 3 : "+f);b=e[1]._val;if("ident"!==e[1]._type){if("int"!==e[1]._type)return a("do not define : "+
b);b=""+b}v=l(e[2]);if("[event]"===v._mode)return v;d={_mode:"[stack]",_type:v._type,_val:v._val,_name:b,_const:"(:"===f};h.push(d);m.push(d)}else if("(="===f){if(3>e.length)return a("arg_size < 3 : "+f);d=k(e[1],e[2]);if("[event]"===d._mode)return d;m.push(d)}else if("(<<"===f){if(3>e.length)return a("arg_size < 3 : "+f);if("@.co"===e[1]._val){d=l(e[2]);if("str"===d._type||"int"===d._type)t+=d._val;else if("list"===d._type){t+="\n[ ";for(n in d._val)t+=d._val[n]._val+", ";t+="]"}else if("map"===
d._type){t+="\n"+d._type+"[ ";for(n in d._val)t+=d._val[n]._name+":"+d._val[n]._val+", ";t+="]"}m.push(e[1])}else if("ident"!==e[1]._type)return a("(468): "+e[1]._name+":"+e[1]._val);for(n=h.length-1;0<=n;n--)if(b=h[n],"[stack]"===b._mode&&b._name===e[1]._val){if(!0===b._const)return a("do not set const "+e[1]._name+":"+e[1]._val);if("map"===b._type||"list"===b._type)d=l(e[2]),"literal"===d._name?b._val.push({_mode:d._mode,_type:d._type,_val:d._val,_name:"."+b._val.length,_const:d._const,_this:b}):
(d=A(d),b._val.push(d));else if("str"===b._type)b._val=""+b._val+l(e[2])._val;else if("int"===b._type){m.push({_mode:"[stack]",_type:b._type,_val:b._val<<l(e[2])._val,_name:"literal",_const:!0});break}m.push(e[1]);break}}else if("(<"===f||"(>"===f||"(<="===f||"(>="===f||"(=="===f||"(!="===f||"(&&"===f||"(||"===f||"(*"===f||"(/"===f||"(+"===f||"(-"===f||"(&"===f||"(|"===f||"(^"===f||"(>>"===f){if(3>e.length)return a("arg_size < 3 : "+f);m.push(p(f,e[1],e[2]))}else if("(??"===f){if(3>e.length)return a("arg_size < 3 : "+
f);if("bool"===e[1]._type&&!0===e[1]._val){d=z(r[e[2]._val]);if("[event]"===d._mode)return d;for(var D in d)m.push(d[D])}else if(4===e.length){d=z(r[e[3]._val]);if("[event]"===d._mode)return d;for(D in d)m.push(d[D])}else m.push({_mode:"[token]",_type:"bool",_val:!1,_const:!0})}else if("(loop"===f){if(3>e.length)return a("arg_size < 3 : "+f);h.push({_mode:"[stack]",_type:"str",_val:"",_name:"out",_const:!1});f=h.length;d=y();for(b=0;100>b;b++){d=z(r[e[2]._val]);if("[event]"===d._mode&&"break"===d._type){if(d._goto!==
e[1]._val){b=B(e[0]._stack_length);if("[event]"===b._mode)return b;m.push(y());return d}h.push(d._val);break}if("[event]"===d._mode&&"continue"===d._type){if(d._goto!==e[1]._val){b=B(e[0]._stack_length);if("[event]"===b._mode)return b;m.push(y());return d}}else if("[event]"===d._mode)return d}if(100<=b)return g("loop limit-over: "+e[1]._val);b=B(e[0]._stack_length);if("[event]"===b._mode)return b;m.push(b)}else if("(each"===f){if(3>e.length)return a("arg_size < 3 : "+f);b=l(e[1]);if("[event]"===b._mode)return b;
s=0;if("str"===b._type)s=b._val.length;else if("int"===b._type)s=b._val;else if("map"===b._type)s=b._val.length;else if("list"===b._type)s=b._val.length;else return a("each type error: "+b._type);h.push({_mode:"[stack]",_type:"str",_val:"",_name:"out",_const:!1});f=h.length;h.push({_mode:"[stack]",_type:b._type,_val:0,_name:"it",_const:!0});h.push({_mode:"[stack]",_type:"int",_val:s,_name:"max",_const:!0});for(var d=y(),x=0;x<s;x++){"str"===b._type?h[f]._val=b._val.substr(x,1):"int"===b._type?h[f]._val=
x:"map"===b._type?(d=A(b._val[x]),d._name="it",h[f]=d):"list"===b._type&&(d=A(b._val[x]),d._name="it",h[f]=d);d=z(r[e[2]._val]);if("[event]"===d._mode&&"break"===d._type){if("each"!==d._goto){b=B(e[0]._stack_length);if("[event]"===b._mode)return b;m.push(y());return d}h.push(d._val);break}if("[event]"===d._mode&&"continue"===d._type){if("each"!==d._goto){b=B(e[0]._stack_length);if("[event]"===b._mode)return b;m.push(y());return d}}else if("[event]"===d._mode)return d}b=B(e[0]._stack_length);if("[event]"===
b._mode)return b;m.push(b)}else{if("(break"===f)return 2===e.length?{_mode:"[event]",_type:"break",_val:y(),_goto:e[1]._val}:3>e.length?a("arg_size < 3 : "+f):{_mode:"[event]",_type:"break",_val:l(e[2]),_goto:e[1]._val};if("(continue"===f)return 2>e.length?a("arg_size < 2 : "+f):{_mode:"[event]",_type:"continue",_val:y(),_goto:e[1]._val};if("(++"===f){if(2>e.length)return a("arg_size < 2 : "+f);m.push(C("+=",e[1],{_mode:"[token]",_type:"int",_val:1}))}else if("(--"===f){if(2>e.length)return a("arg_size < 2 : "+
f);m.push(C("-=",e[1],{_mode:"[token]",_type:"int",_val:1}))}else if("(+="===f){if(3>e.length)return a("arg_size < 3 : "+f);m.push(C("+=",e[1],e[2]))}else if("(-="===f){if(3>e.length)return a("arg_size < 3 : "+f);m.push(C("-=",e[1],e[2]))}else if("(*="===f){if(3>e.length)return a("arg_size < 3 : "+f);m.push(C("*=",e[1],e[2]))}else if("(/="===f){if(3>e.length)return a("arg_size < 3 : "+f);m.push(C("/=",e[1],e[2]))}else if("(call"===f){if(3>e.length)return a("arg_size < 3 : "+f);b=l(e[1]);if("[event]"===
b._mode)return b;if(b._this)for(d=b._this._val,n=d.length-1;0<=n;n--)"[stack]"===d[n]._mode&&h.push(d[n]);f=h.length;if(3===e.length){d=z(r[e[2]._val]);if("[event]"===d._mode)return d;for(n=h.length-1;f-1<n;n--)h[n]._name="_"+h[n]._name;h.push({_mode:"[stack]",_type:"int",_val:h.length-f,_name:"arg_size",_const:!0})}for(e=0;e<f;e++)s=h[e]._name,"_"===s[0]&&(h[e]._name="_."+s);s=h.length;if("func_no"!==b._type)return a("func_no: "+b._val);d=z(r[b._val]);if("[event]"===d._mode){if("return"!==d._type){for(;f<
h.length;)h.pop();return d}d=d._val}if("list"!==d._type&&"map"!==d._type){x={_mode:"[stack]",_type:"list",_val:[],_name:"out",_const:!1};b=!1;for(n in d){var q=A(d[n]);q._name&&".literal"!==q._name&&"literal"!==q._name?"out"===q._name?b=q:(q._this=x,x._val.push(q)):!1===b&&(b=l(q))}!1!==b&&(b._name=".0",b._const=!0,b._this=x,x._val.push(b));d=x}else for(n in d._val)q=d._val[n],q._name="."+q._name;for(;s<h.length;)b=h.pop();for(;f<h.length;)b=h.pop(),b._this=d,d._val.push(b);for(e in h)s=h[e]._name,
"_"===s[0]&&"."===s[1]&&(h[e]._name=s.substr(2,s.length-2));m.push(d)}else{if("(return"===f){if(2>e.length)return a("arg_size < 2 : "+f);d=l(e[1]);if("[event]"===d._mode)return d;if("list"===d._type||"map"===d._type)for(n in D=0,d._val)q=A(d._val[n]),d._val[n]._name?q._name="."+q._name:(q=A(l(q)),q._name="."+D,D++),m.push(q);else return a("return not list : "+f);return{_mode:"[event]",_type:"return",_val:m}}if("(line"===f)u=e[1]._val;else return a("program_error: "+f)}}}}return m}var r=[],h=[],w=
[],t="",u="",J=function(h){for(var a="",g=0;g<h.length;g++)switch(h[g]){case "'":a+="s";break;case '"':a+="S";break;case "/":a+="b";break;case "-":a+="b";break;case ".":a+="b";break;case "\n":a+="e";break;default:a+=" "}for(var l="",k=" ",g=0;g<a.length;g++){switch(a[g]){case "s":"s"===k?k=" ":"S"!==k&&(k="s");break;case "S":"S"===k?k=" ":"s"!==k&&(k="S")}l=" "!==k?l+k:l+a[g]}a="";k=" ";for(g=0;g<l.length;g++){c=l[g];switch(k+c){case " b":case "eb":"//"===h.substr(g,2)&&(c="c"),"---"===h.substr(g,
3)&&(c="c"),"..."===h.substr(g,3)&&(c="c")}switch(c){case "c":k="c";break;case "e":k=" "}" "===k&&(a+=h[g])}return a}(G);(function(h){function a(a){if("a:true"===a)return{_mode:"[stack]",_type:"bool",_val:!0,_name:"literal",_const:!0};if("a:false"===a)return{_mode:"[stack]",_type:"bool",_val:!1,_name:"literal",_const:!0};var g=a.substr(0,2);return"0:"===g?{_mode:"[stack]",_type:"int",_val:parseInt(a.substr(2,a.length-2)),_name:"literal",_const:!0}:"s:"===g?{_mode:"[stack]",_type:"str",_val:a.substr(3,
a.length-2-2),_name:"literal",_const:!0}:{_mode:"[token]",_type:"ident",_val:a.substr(2,a.length-2)}}r=[];for(var g=[],l=0;l<h.length;l++)if("}:}"===h[l])for(var k=[],p;p=g.pop();)if("ident"===p._type&&"{"===p._val){p=r.length;r.push(k);g.push({_mode:"[token]",_type:"func_no",_val:p});break}else k.unshift(p);else if("]:]"===h[l])for(k=[];p=g.pop();)if("ident"===p._type&&"["===p._val){p=r.length;r.push(k);g.push({_mode:"[token]",_type:"list_no",_val:p});break}else k.unshift(p);else g.push(a(h[l]));
r.push(g)})(function(h){for(var a="",g=0;g<J.length;g++)switch(h[g]){case " ":a+=" ";break;case "!":a+="a";break;case '"':a+="S";break;case "#":a+="a";break;case "$":a+="a";break;case "%":a+="a";break;case "&":a+="a";break;case "'":a+="s";break;case "(":a+="a";break;case ")":a+=")";break;case "*":a+="a";break;case "+":a+="a";break;case ",":a+="a";break;case "-":a+="a";break;case ".":a+="a";break;case "/":a+="a";break;case "0":a+="0";break;case "1":a+="0";break;case "2":a+="0";break;case "3":a+="0";
break;case "4":a+="0";break;case "5":a+="0";break;case "6":a+="0";break;case "7":a+="0";break;case "8":a+="0";break;case "9":a+="0";break;case ":":a+="a";break;case ";":a+="a";break;case "<":a+="a";break;case "=":a+="a";break;case ">":a+="a";break;case "?":a+="a";break;case "@":a+="a";break;case "A":a+="a";break;case "B":a+="a";break;case "C":a+="a";break;case "D":a+="a";break;case "E":a+="a";break;case "F":a+="a";break;case "G":a+="a";break;case "H":a+="a";break;case "I":a+="a";break;case "J":a+=
"a";break;case "K":a+="a";break;case "L":a+="a";break;case "M":a+="a";break;case "N":a+="a";break;case "O":a+="a";break;case "P":a+="a";break;case "Q":a+="a";break;case "R":a+="a";break;case "S":a+="a";break;case "T":a+="a";break;case "U":a+="a";break;case "V":a+="a";break;case "W":a+="a";break;case "X":a+="a";break;case "Y":a+="a";break;case "Z":a+="a";break;case "[":a+="[";break;case "\\":a+="a";break;case "]":a+="]";break;case "^":a+="a";break;case "_":a+="a";break;case "`":a+="a";break;case "a":a+=
"a";break;case "b":a+="a";break;case "c":a+="a";break;case "d":a+="a";break;case "e":a+="a";break;case "f":a+="a";break;case "g":a+="a";break;case "h":a+="a";break;case "i":a+="a";break;case "j":a+="a";break;case "k":a+="a";break;case "l":a+="a";break;case "m":a+="a";break;case "n":a+="a";break;case "o":a+="a";break;case "p":a+="a";break;case "q":a+="a";break;case "r":a+="a";break;case "s":a+="a";break;case "t":a+="a";break;case "u":a+="a";break;case "v":a+="a";break;case "w":a+="a";break;case "x":a+=
"a";break;case "y":a+="a";break;case "z":a+="a";break;case "{":a+="{";break;case "|":a+="a";break;case "}":a+="}";break;case "~":a+="a";break;default:a+=" "}for(var l="",k=" ",g=0;g<a.length;g++){switch(a[g]){case "s":"s"===k?k=" ":"S"!==k&&(k="s");break;case "S":"S"===k?k=" ":"s"!==k&&(k="S")}" "===k&&0<g&&"a"===a[g-1]&&"0"===a[g]?k="a":"a"===k&&"a"!==a[g]&&"0"!==a[g]&&(k=" ");l=" "!==k?l+k:l+a[g]}for(var a="",k=l[0],p=[],g=0;g<l.length;g++)k===l[g]?a+=h[g]:(" "!==k&&p.push(k+":"+a),a=h[g],k=l[g]);
" "!==k&&p.push(k+":"+a);return p}(J));z(r[r.length-1]);0<w.length&&(t+="\nerror_list : \n"+w+"\n");if("OK"===H&&0===w.length||"NG"===H&&0!==w.length)return"d(^-^)b";document.getElementById("kawasemi_output").value+=t+"\n";return(0===w.length?"OK! d(^-^)b -> ":"NG! q(ToT)p -> ")+G};